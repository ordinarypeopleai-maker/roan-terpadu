<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Ro'an Terpadu</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

<style>
body{margin:0;font-family:Segoe UI,Arial,sans-serif;background:#f4f6f8}
header{background:#0f4c75;color:#fff;padding:20px;text-align:center}
main{max-width:1100px;margin:auto;padding:16px}
.controls{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:12px}
select,input,button{padding:8px 12px;border-radius:6px;border:1px solid #ccc;font-size:14px}
button{background:#0f4c75;color:#fff;border:none;cursor:pointer}
table{width:100%;border-collapse:collapse;background:#fff;border-radius:10px;overflow:hidden}
th,td{padding:10px;border-bottom:1px solid #eee;font-size:14px}
th{background:#f0f2f5}
tr:nth-child(even){background:#fafafa}
.jumat{font-weight:bold;color:#0f4c75}
.minggu{font-style:italic;color:#777}
footer{text-align:center;font-size:12px;margin:12px 0;color:#777}
</style>
</head>

<body>

<header>
<h1>Ro'an Terpadu</h1>
<p>Jadwal Ro'an TPS Desember 2025 – Desember 2029</p>
</header>

<main>

<div class="controls">
<select id="bulan"></select>
<select id="tahun"></select>
<input id="cari" placeholder="Cari Komplek">
<button onclick="render()">Tampilkan</button>
<button onclick="exportCSV()">CSV</button>
<button onclick="exportExcel()">Excel</button>
</div>

<table id="tabel">
<thead>
<tr><th>Tanggal</th><th>Hari</th><th>Petugas</th></tr>
</thead>
<tbody></tbody>
</table>

<footer>© Ro'an Terpadu</footer>
</main>

<script>
/* ===================== DATA ===================== */
const komplek=["A","B","C","D","E","F","G","H","I","J"];
const data=[];

let d=new Date(2025,11,1);
const end=new Date(2029,11,31);

let dailyIndex=4;   // E
let fridayIndex=4;  // E

while(d<=end){
  const day=d.getDay();
  let petugas="";

  if(day===0){
    petugas="Pengurus kebersihan";
  }else if(day===5){
    petugas=komplek[fridayIndex%10];
    fridayIndex++;
  }else{
    petugas=komplek[dailyIndex%10];
    dailyIndex++;
  }

  data.push({
    tanggal:d.toLocaleDateString("id-ID"),
    hari:d.toLocaleDateString("id-ID",{weekday:"long"}),
    petugas,
    bulan:d.getMonth(),
    tahun:d.getFullYear(),
    day
  });

  d.setDate(d.getDate()+1);
}

/* ===================== FILTER ===================== */
const bulanNama=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"];
bulanNama.forEach((b,i)=>bulan.innerHTML+=`<option value="${i}">${b}</option>`);
for(let y=2025;y<=2029;y++) tahun.innerHTML+=`<option>${y}</option>`;

bulan.value=11;
tahun.value=2025;

/* ===================== RENDER ===================== */
function render(){
  const tbody=document.querySelector("tbody");
  tbody.innerHTML="";
  const q=cari.value.toUpperCase();

  data.filter(x=>
    x.bulan==bulan.value
